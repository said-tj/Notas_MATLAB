clear all; clc;

% Uxx - alpha*Utt = 0
% u(x,0) = g(x),  ut(x,0) = f(x), u(0,t) = u(L,t) = 0

g = @(x) 0;
f = @(x) sin(pi*x);
tf=0.2;
L = 30;
n = 3; m = 1;
alpha = 1;
hx = L / n;
ht = tf / m;

x = linspace(0, L, n+1);
t = linspace(0, tf, m+1);
M1=zeros((n+3)*(m+3));
M2=zeros((n+3)*(m+3));

E=[(1/112)*hx (129/2240)*hx (3/112)*hx (1/2240)*hx;
    (129/2240)*hx (51/112)*hx (933/2240)*hx (3/112)*hx;
    (3/112)*hx  (933/2240)*hx (51/112)*hx (129/2240)*hx;
   (1/2240)*hx (3/112)*hx (129/2240)*hx (1/112)*hx];

Exx=[3/(40*hx) -21/(160*hx) 3/(80*hx) 3/(160*hx);
    99/(160*hx)  -33/(40*hx) -33/(160*hx) 33/(80*hx);
    33/(80*hx)  -33/(160*hx) -33/(40*hx) 99/(160*hx);
    3/(160*hx)  3/(80*hx) -21/(160*hx) 3/(40*hx);
    ];
Ltt=[3/(40*ht) -21/(160*ht) 3/(80*ht) 3/(160*ht);
    99/(160*ht)  -33/(40*ht) -33/(160*ht) 33/(80*ht);
    33/(80*ht)  -33/(160*ht) -33/(40*ht) 99/(160*ht);
    3/(160*ht)  3/(80*ht) -21/(160*ht) 3/(40*ht);
    ];
L=[(1/112)*ht (129/2240)*ht (3/112)*ht (1/2240)*ht;
    (129/2240)*ht (51/112)*ht (933/2240)*ht (3/112)*ht;
    (3/112)*ht  (933/2240)*ht (51/112)*ht (129/2240)*ht;
   (1/2240)*ht (3/112)*ht (129/2240)*ht (1/112)*ht];


for i=1:4
    for j=1:4
        M1((i-1)*4+1:i*4,(j-1)*4+1:j*4)=Exx*L(i,j);
        M2((i-1)*4+1:i*4,(j-1)*4+1:j*4)=E*Ltt(i,j);
    end
end
M=M1-alpha*M2;



